{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "common/active_surface.json",
  "title": "Active Surface Boss",
  "type": "object",
  "description": "This schema is sent by the DISCOS Active Surface component.",
  "node": "active_surface",
  "$defs": {
    "SECTOR": {
      "type": "object",
      "title": "Active surface sector",
      "description": "Sector of the primary mirror.",
      "patternProperties": {
        "^LAN(0[1-9]|1[0-2])$": { "$ref": "#/$defs/LAN" }
      },
      "additionalProperties": false
    },
    "LAN": {
      "type": "object",
      "title": "Sector LAN",
      "description": "Ethernet to serial converter.",
      "properties": {
        "connected": {
          "type": "boolean",
          "title": "Connected",
          "description": "Component is connected to the ethernet to serial converter."
        }
      },
      "required": [
        "connected"
      ],
      "patternProperties": {
        "^USD(0[1-9]|1[0-7])$": { "$ref": "#/$defs/USD" }
      },
      "additionalProperties": false
    },
    "USD": {
      "type": "object",
      "title": "USD",
      "description": "USD component.",
      "properties": {
        "accelerationFactor": {
          "type": "number",
          "title": "Acceleration Factor",
          "description": "USD acceleration factor."
        },
        "available": {
          "type": "boolean",
          "title": "Available",
          "description": "Indicates whether the USD is available or not."
        },
        "calibrated": {
          "type": "boolean",
          "title": "Calibrated",
          "description": "Indicates whether the USD is calibrated or not."
        },
        "commandedPosition": {
          "type": "number",
          "title": "Commanded Position",
          "description": "USD commanded position.",
          "unit": "μstep"
        },
        "currentPosition": {
          "type": "number",
          "title": "Current Position",
          "description": "USD current position.",
          "unit": "μstep"
        },
        "delay": {
          "type": "number",
          "title": "Delay",
          "description": "USD delay on response. A value equal to -1 means no response is expected to be received.",
          "unit": "μs"
        },
        "enabled": {
          "type": "boolean",
          "title": "Enabled",
          "description": "Indicates whether the USD is enabled or not."
        },
        "maximumFrequency": {
          "type": "number",
          "title": "Maximum Frequency",
          "description": "USD maximum frequency.",
          "unit": "Hz"
        },
        "minimumFrequency": {
          "type": "number",
          "title": "Minimum Frequency",
          "description": "USD minimum frequency.",
          "unit": "Hz"
        },
        "running": {
          "type": "boolean",
          "title": "Running",
          "description": "Indicates whether the USD is moving or not."
        },
        "softwareVersion": {
          "type": "string",
          "title": "Software Version",
          "description": "USD software version."
        },
        "USDType": {
          "type": "string",
          "title": "USD Type",
          "description": "USD type.",
          "enum": [
            "USD50xxx",
            "USD60xxx"
          ]
        }
      },
      "additionalProperties": false
    }
  },
  "properties": {
    "LUTFilename": {
      "type": "string",
      "title": "LookUp Table file name",
      "description": "Name of the lookup table file being used."
    },
    "profile": {
      "type": "string",
      "title": "Profile",
      "description": "Current active surface pointing profile.",
      "enum": [
        "PARK",
        "SHAPED",
        "SHAPED FIXED",
        "PARABOLIC",
        "PARABOLIC FIXED"
      ]
    },
    "status": {
      "$ref": "../definitions/status.json"
    },
    "timestamp": {
      "$ref": "../definitions/timestamp.json"
    },
    "tracking": {
      "type": "boolean",
      "title": "Tracking",
      "description": "Indicates whether the Active Surface is tracking, i.e., if the primary mirror is refreshed when the elvation changes."
    }
  },
  "patternProperties": {
    "^SECTOR0[1-8]$": { "$ref": "#/$defs/SECTOR" }
  },
  "required": [
    "LUTFilename",
    "profile",
    "status",
    "timestamp",
    "tracking"
  ],
  "additionalProperties": false
}
